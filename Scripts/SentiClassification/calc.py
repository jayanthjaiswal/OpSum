from __future__ import unicode_literals
import glob, os, sys
import nltk, os, pickle
from nltk.util import ngrams
from nltk.tokenize import PunktWordTokenizer
from nlpsenti import Splitter,POSTagger
from nltk.stem import WordNetLemmatizer

pkl_file = open("NBJaccard.pickle","rb")
splitter = Splitter()
postagger = POSTagger()
classifier = pickle.load(pkl_file)
wnl = WordNetLemmatizer()

def class_1(text):
	#test take arg
	splitted_sentences = splitter.split(text)
	splitted_words = [item for sublist in splitted_sentences for item in sublist]
	postagedsent = nltk.pos_tag(splitted_words)
	words = [u[0] for u in postagedsent if u[1]!="NNP"]
	lemwords = [wnl.lemmatize(word) if word!="have" and word!="has" else "have" for word in words]
	feats = dict([(word, True) for word in lemwords + ngrams(lemwords, 2)])
	#print feats
	p = classifier.prob_classify(feats)
	pro = classifier.classify(feats)    
	#print pro, p.prob('pos'), p.prob('neg')
	#print pro
	return p.prob('pos')


def func(dirs):
	fnames=['A1_ALPHA0.0_R0.0', 'A1_ALPHA0.0_R1.0', 'A1_ALPHA0.0_R10.0', 'A1_ALPHA0.0_R2.0', 'A1_ALPHA0.0_R3.0', 'A1_ALPHA0.0_R4.0', 'A1_ALPHA0.0_R5.0', 'A1_ALPHA0.0_R6.0', 'A1_ALPHA0.0_R7.0', 'A1_ALPHA0.0_R8.0', 'A1_ALPHA0.0_R9.0', 'A1_ALPHA0.5_R0.0', 'A1_ALPHA0.5_R1.0', 'A1_ALPHA0.5_R10.0', 'A1_ALPHA0.5_R2.0', 'A1_ALPHA0.5_R3.0', 'A1_ALPHA0.5_R4.0', 'A1_ALPHA0.5_R5.0', 'A1_ALPHA0.5_R6.0', 'A1_ALPHA0.5_R7.0', 'A1_ALPHA0.5_R8.0', 'A1_ALPHA0.5_R9.0', 'A1_ALPHA1.0_R0.0', 'A1_ALPHA1.0_R1.0', 'A1_ALPHA1.0_R10.0', 'A1_ALPHA1.0_R2.0', 'A1_ALPHA1.0_R3.0', 'A1_ALPHA1.0_R4.0', 'A1_ALPHA1.0_R5.0', 'A1_ALPHA1.0_R6.0', 'A1_ALPHA1.0_R7.0', 'A1_ALPHA1.0_R8.0', 'A1_ALPHA1.0_R9.0', 'A1_ALPHA1.5_R0.0', 'A1_ALPHA1.5_R1.0', 'A1_ALPHA1.5_R10.0', 'A1_ALPHA1.5_R2.0', 'A1_ALPHA1.5_R3.0', 'A1_ALPHA1.5_R4.0', 'A1_ALPHA1.5_R5.0', 'A1_ALPHA1.5_R6.0', 'A1_ALPHA1.5_R7.0', 'A1_ALPHA1.5_R8.0', 'A1_ALPHA1.5_R9.0', 'A1_ALPHA2.0_R0.0', 'A1_ALPHA2.0_R1.0', 'A1_ALPHA2.0_R10.0', 'A1_ALPHA2.0_R2.0', 'A1_ALPHA2.0_R3.0', 'A1_ALPHA2.0_R4.0', 'A1_ALPHA2.0_R5.0', 'A1_ALPHA2.0_R6.0', 'A1_ALPHA2.0_R7.0', 'A1_ALPHA2.0_R8.0', 'A1_ALPHA2.0_R9.0', 'A1_ALPHA2.5_R0.0', 'A1_ALPHA2.5_R1.0', 'A1_ALPHA2.5_R10.0', 'A1_ALPHA2.5_R2.0', 'A1_ALPHA2.5_R3.0', 'A1_ALPHA2.5_R4.0', 'A1_ALPHA2.5_R5.0', 'A1_ALPHA2.5_R6.0', 'A1_ALPHA2.5_R7.0', 'A1_ALPHA2.5_R8.0', 'A1_ALPHA2.5_R9.0', 'A1_ALPHA3.0_R0.0', 'A1_ALPHA3.0_R1.0', 'A1_ALPHA3.0_R10.0', 'A1_ALPHA3.0_R2.0', 'A1_ALPHA3.0_R3.0', 'A1_ALPHA3.0_R4.0', 'A1_ALPHA3.0_R5.0', 'A1_ALPHA3.0_R6.0', 'A1_ALPHA3.0_R7.0', 'A1_ALPHA3.0_R8.0', 'A1_ALPHA3.0_R9.0', 'A1_ALPHA3.5_R0.0', 'A1_ALPHA3.5_R1.0', 'A1_ALPHA3.5_R10.0', 'A1_ALPHA3.5_R2.0', 'A1_ALPHA3.5_R3.0', 'A1_ALPHA3.5_R4.0', 'A1_ALPHA3.5_R5.0', 'A1_ALPHA3.5_R6.0', 'A1_ALPHA3.5_R7.0', 'A1_ALPHA3.5_R8.0', 'A1_ALPHA3.5_R9.0', 'A1_ALPHA4.0_R0.0', 'A1_ALPHA4.0_R1.0', 'A1_ALPHA4.0_R10.0', 'A1_ALPHA4.0_R2.0', 'A1_ALPHA4.0_R3.0', 'A1_ALPHA4.0_R4.0', 'A1_ALPHA4.0_R5.0', 'A1_ALPHA4.0_R6.0', 'A1_ALPHA4.0_R7.0', 'A1_ALPHA4.0_R8.0', 'A1_ALPHA4.0_R9.0', 'A1_ALPHA4.5_R0.0', 'A1_ALPHA4.5_R1.0', 'A1_ALPHA4.5_R10.0', 'A1_ALPHA4.5_R2.0', 'A1_ALPHA4.5_R3.0', 'A1_ALPHA4.5_R4.0', 'A1_ALPHA4.5_R5.0', 'A1_ALPHA4.5_R6.0', 'A1_ALPHA4.5_R7.0', 'A1_ALPHA4.5_R8.0', 'A1_ALPHA4.5_R9.0', 'A1_ALPHA5.0_R0.0', 'A1_ALPHA5.0_R1.0', 'A1_ALPHA5.0_R10.0', 'A1_ALPHA5.0_R2.0', 'A1_ALPHA5.0_R3.0', 'A1_ALPHA5.0_R4.0', 'A1_ALPHA5.0_R5.0', 'A1_ALPHA5.0_R6.0', 'A1_ALPHA5.0_R7.0', 'A1_ALPHA5.0_R8.0', 'A1_ALPHA5.0_R9.0', 'A2_ALPHA0.0_R0.0', 'A2_ALPHA0.0_R1.0', 'A2_ALPHA0.0_R10.0', 'A2_ALPHA0.0_R2.0', 'A2_ALPHA0.0_R3.0', 'A2_ALPHA0.0_R4.0', 'A2_ALPHA0.0_R5.0', 'A2_ALPHA0.0_R6.0', 'A2_ALPHA0.0_R7.0', 'A2_ALPHA0.0_R8.0', 'A2_ALPHA0.0_R9.0', 'A2_ALPHA0.5_R0.0', 'A2_ALPHA0.5_R1.0', 'A2_ALPHA0.5_R10.0', 'A2_ALPHA0.5_R2.0', 'A2_ALPHA0.5_R3.0', 'A2_ALPHA0.5_R4.0', 'A2_ALPHA0.5_R5.0', 'A2_ALPHA0.5_R6.0', 'A2_ALPHA0.5_R7.0', 'A2_ALPHA0.5_R8.0', 'A2_ALPHA0.5_R9.0', 'A2_ALPHA1.0_R0.0', 'A2_ALPHA1.0_R1.0', 'A2_ALPHA1.0_R10.0', 'A2_ALPHA1.0_R2.0', 'A2_ALPHA1.0_R3.0', 'A2_ALPHA1.0_R4.0', 'A2_ALPHA1.0_R5.0', 'A2_ALPHA1.0_R6.0', 'A2_ALPHA1.0_R7.0', 'A2_ALPHA1.0_R8.0', 'A2_ALPHA1.0_R9.0', 'A2_ALPHA1.5_R0.0', 'A2_ALPHA1.5_R1.0', 'A2_ALPHA1.5_R10.0', 'A2_ALPHA1.5_R2.0', 'A2_ALPHA1.5_R3.0', 'A2_ALPHA1.5_R4.0', 'A2_ALPHA1.5_R5.0', 'A2_ALPHA1.5_R6.0', 'A2_ALPHA1.5_R7.0', 'A2_ALPHA1.5_R8.0', 'A2_ALPHA1.5_R9.0', 'A2_ALPHA2.0_R0.0', 'A2_ALPHA2.0_R1.0', 'A2_ALPHA2.0_R10.0', 'A2_ALPHA2.0_R2.0', 'A2_ALPHA2.0_R3.0', 'A2_ALPHA2.0_R4.0', 'A2_ALPHA2.0_R5.0', 'A2_ALPHA2.0_R6.0', 'A2_ALPHA2.0_R7.0', 'A2_ALPHA2.0_R8.0', 'A2_ALPHA2.0_R9.0', 'A2_ALPHA2.5_R0.0', 'A2_ALPHA2.5_R1.0', 'A2_ALPHA2.5_R10.0', 'A2_ALPHA2.5_R2.0', 'A2_ALPHA2.5_R3.0', 'A2_ALPHA2.5_R4.0', 'A2_ALPHA2.5_R5.0', 'A2_ALPHA2.5_R6.0', 'A2_ALPHA2.5_R7.0', 'A2_ALPHA2.5_R8.0', 'A2_ALPHA2.5_R9.0', 'A2_ALPHA3.0_R0.0', 'A2_ALPHA3.0_R1.0', 'A2_ALPHA3.0_R10.0', 'A2_ALPHA3.0_R2.0', 'A2_ALPHA3.0_R3.0', 'A2_ALPHA3.0_R4.0', 'A2_ALPHA3.0_R5.0', 'A2_ALPHA3.0_R6.0', 'A2_ALPHA3.0_R7.0', 'A2_ALPHA3.0_R8.0', 'A2_ALPHA3.0_R9.0', 'A2_ALPHA3.5_R0.0', 'A2_ALPHA3.5_R1.0', 'A2_ALPHA3.5_R10.0', 'A2_ALPHA3.5_R2.0', 'A2_ALPHA3.5_R3.0', 'A2_ALPHA3.5_R4.0', 'A2_ALPHA3.5_R5.0', 'A2_ALPHA3.5_R6.0', 'A2_ALPHA3.5_R7.0', 'A2_ALPHA3.5_R8.0', 'A2_ALPHA3.5_R9.0', 'A2_ALPHA4.0_R0.0', 'A2_ALPHA4.0_R1.0', 'A2_ALPHA4.0_R10.0', 'A2_ALPHA4.0_R2.0', 'A2_ALPHA4.0_R3.0', 'A2_ALPHA4.0_R4.0', 'A2_ALPHA4.0_R5.0', 'A2_ALPHA4.0_R6.0', 'A2_ALPHA4.0_R7.0', 'A2_ALPHA4.0_R8.0', 'A2_ALPHA4.0_R9.0', 'A2_ALPHA4.5_R0.0', 'A2_ALPHA4.5_R1.0', 'A2_ALPHA4.5_R10.0', 'A2_ALPHA4.5_R2.0', 'A2_ALPHA4.5_R3.0', 'A2_ALPHA4.5_R4.0', 'A2_ALPHA4.5_R5.0', 'A2_ALPHA4.5_R6.0', 'A2_ALPHA4.5_R7.0', 'A2_ALPHA4.5_R8.0', 'A2_ALPHA4.5_R9.0', 'A2_ALPHA5.0_R0.0', 'A2_ALPHA5.0_R1.0', 'A2_ALPHA5.0_R10.0', 'A2_ALPHA5.0_R2.0', 'A2_ALPHA5.0_R3.0', 'A2_ALPHA5.0_R4.0', 'A2_ALPHA5.0_R5.0', 'A2_ALPHA5.0_R6.0', 'A2_ALPHA5.0_R7.0', 'A2_ALPHA5.0_R8.0', 'A2_ALPHA5.0_R9.0', 'A3_ALPHA0.0_R0.0', 'A3_ALPHA0.0_R1.0', 'A3_ALPHA0.0_R10.0', 'A3_ALPHA0.0_R2.0', 'A3_ALPHA0.0_R3.0', 'A3_ALPHA0.0_R4.0', 'A3_ALPHA0.0_R5.0', 'A3_ALPHA0.0_R6.0', 'A3_ALPHA0.0_R7.0', 'A3_ALPHA0.0_R8.0', 'A3_ALPHA0.0_R9.0', 'A3_ALPHA0.5_R0.0', 'A3_ALPHA0.5_R1.0', 'A3_ALPHA0.5_R10.0', 'A3_ALPHA0.5_R2.0', 'A3_ALPHA0.5_R3.0', 'A3_ALPHA0.5_R4.0', 'A3_ALPHA0.5_R5.0', 'A3_ALPHA0.5_R6.0', 'A3_ALPHA0.5_R7.0', 'A3_ALPHA0.5_R8.0', 'A3_ALPHA0.5_R9.0', 'A3_ALPHA1.0_R0.0', 'A3_ALPHA1.0_R1.0', 'A3_ALPHA1.0_R10.0', 'A3_ALPHA1.0_R2.0', 'A3_ALPHA1.0_R3.0', 'A3_ALPHA1.0_R4.0', 'A3_ALPHA1.0_R5.0', 'A3_ALPHA1.0_R6.0', 'A3_ALPHA1.0_R7.0', 'A3_ALPHA1.0_R8.0', 'A3_ALPHA1.0_R9.0', 'A3_ALPHA1.5_R0.0', 'A3_ALPHA1.5_R1.0', 'A3_ALPHA1.5_R10.0', 'A3_ALPHA1.5_R2.0', 'A3_ALPHA1.5_R3.0', 'A3_ALPHA1.5_R4.0', 'A3_ALPHA1.5_R5.0', 'A3_ALPHA1.5_R6.0', 'A3_ALPHA1.5_R7.0', 'A3_ALPHA1.5_R8.0', 'A3_ALPHA1.5_R9.0', 'A3_ALPHA2.0_R0.0', 'A3_ALPHA2.0_R1.0', 'A3_ALPHA2.0_R10.0', 'A3_ALPHA2.0_R2.0', 'A3_ALPHA2.0_R3.0', 'A3_ALPHA2.0_R4.0', 'A3_ALPHA2.0_R5.0', 'A3_ALPHA2.0_R6.0', 'A3_ALPHA2.0_R7.0', 'A3_ALPHA2.0_R8.0', 'A3_ALPHA2.0_R9.0', 'A3_ALPHA2.5_R0.0', 'A3_ALPHA2.5_R1.0', 'A3_ALPHA2.5_R10.0', 'A3_ALPHA2.5_R2.0', 'A3_ALPHA2.5_R3.0', 'A3_ALPHA2.5_R4.0', 'A3_ALPHA2.5_R5.0', 'A3_ALPHA2.5_R6.0', 'A3_ALPHA2.5_R7.0', 'A3_ALPHA2.5_R8.0', 'A3_ALPHA2.5_R9.0', 'A3_ALPHA3.0_R0.0', 'A3_ALPHA3.0_R1.0', 'A3_ALPHA3.0_R10.0', 'A3_ALPHA3.0_R2.0', 'A3_ALPHA3.0_R3.0', 'A3_ALPHA3.0_R4.0', 'A3_ALPHA3.0_R5.0', 'A3_ALPHA3.0_R6.0', 'A3_ALPHA3.0_R7.0', 'A3_ALPHA3.0_R8.0', 'A3_ALPHA3.0_R9.0', 'A3_ALPHA3.5_R0.0', 'A3_ALPHA3.5_R1.0', 'A3_ALPHA3.5_R10.0', 'A3_ALPHA3.5_R2.0', 'A3_ALPHA3.5_R3.0', 'A3_ALPHA3.5_R4.0', 'A3_ALPHA3.5_R5.0', 'A3_ALPHA3.5_R6.0', 'A3_ALPHA3.5_R7.0', 'A3_ALPHA3.5_R8.0', 'A3_ALPHA3.5_R9.0', 'A3_ALPHA4.0_R0.0', 'A3_ALPHA4.0_R1.0', 'A3_ALPHA4.0_R10.0', 'A3_ALPHA4.0_R2.0', 'A3_ALPHA4.0_R3.0', 'A3_ALPHA4.0_R4.0', 'A3_ALPHA4.0_R5.0', 'A3_ALPHA4.0_R6.0', 'A3_ALPHA4.0_R7.0', 'A3_ALPHA4.0_R8.0', 'A3_ALPHA4.0_R9.0', 'A3_ALPHA4.5_R0.0', 'A3_ALPHA4.5_R1.0', 'A3_ALPHA4.5_R10.0', 'A3_ALPHA4.5_R2.0', 'A3_ALPHA4.5_R3.0', 'A3_ALPHA4.5_R4.0', 'A3_ALPHA4.5_R5.0', 'A3_ALPHA4.5_R6.0', 'A3_ALPHA4.5_R7.0', 'A3_ALPHA4.5_R8.0', 'A3_ALPHA4.5_R9.0', 'A3_ALPHA5.0_R0.0', 'A3_ALPHA5.0_R1.0', 'A3_ALPHA5.0_R10.0', 'A3_ALPHA5.0_R2.0', 'A3_ALPHA5.0_R3.0', 'A3_ALPHA5.0_R4.0', 'A3_ALPHA5.0_R5.0', 'A3_ALPHA5.0_R6.0', 'A3_ALPHA5.0_R7.0', 'A3_ALPHA5.0_R8.0', 'A3_ALPHA5.0_R9.0', 'A4_ALPHA0.0_R0.0', 'A4_ALPHA0.0_R1.0', 'A4_ALPHA0.0_R10.0', 'A4_ALPHA0.0_R2.0', 'A4_ALPHA0.0_R3.0', 'A4_ALPHA0.0_R4.0', 'A4_ALPHA0.0_R5.0', 'A4_ALPHA0.0_R6.0', 'A4_ALPHA0.0_R7.0', 'A4_ALPHA0.0_R8.0', 'A4_ALPHA0.0_R9.0', 'A4_ALPHA0.5_R0.0', 'A4_ALPHA0.5_R1.0', 'A4_ALPHA0.5_R10.0', 'A4_ALPHA0.5_R2.0', 'A4_ALPHA0.5_R3.0', 'A4_ALPHA0.5_R4.0', 'A4_ALPHA0.5_R5.0', 'A4_ALPHA0.5_R6.0', 'A4_ALPHA0.5_R7.0', 'A4_ALPHA0.5_R8.0', 'A4_ALPHA0.5_R9.0', 'A4_ALPHA1.0_R0.0', 'A4_ALPHA1.0_R1.0', 'A4_ALPHA1.0_R10.0', 'A4_ALPHA1.0_R2.0', 'A4_ALPHA1.0_R3.0', 'A4_ALPHA1.0_R4.0', 'A4_ALPHA1.0_R5.0', 'A4_ALPHA1.0_R6.0', 'A4_ALPHA1.0_R7.0', 'A4_ALPHA1.0_R8.0', 'A4_ALPHA1.0_R9.0', 'A4_ALPHA1.5_R0.0', 'A4_ALPHA1.5_R1.0', 'A4_ALPHA1.5_R10.0', 'A4_ALPHA1.5_R2.0', 'A4_ALPHA1.5_R3.0', 'A4_ALPHA1.5_R4.0', 'A4_ALPHA1.5_R5.0', 'A4_ALPHA1.5_R6.0', 'A4_ALPHA1.5_R7.0', 'A4_ALPHA1.5_R8.0', 'A4_ALPHA1.5_R9.0', 'A4_ALPHA2.0_R0.0', 'A4_ALPHA2.0_R1.0', 'A4_ALPHA2.0_R10.0', 'A4_ALPHA2.0_R2.0', 'A4_ALPHA2.0_R3.0', 'A4_ALPHA2.0_R4.0', 'A4_ALPHA2.0_R5.0', 'A4_ALPHA2.0_R6.0', 'A4_ALPHA2.0_R7.0', 'A4_ALPHA2.0_R8.0', 'A4_ALPHA2.0_R9.0', 'A4_ALPHA2.5_R0.0', 'A4_ALPHA2.5_R1.0', 'A4_ALPHA2.5_R10.0', 'A4_ALPHA2.5_R2.0', 'A4_ALPHA2.5_R3.0', 'A4_ALPHA2.5_R4.0', 'A4_ALPHA2.5_R5.0', 'A4_ALPHA2.5_R6.0', 'A4_ALPHA2.5_R7.0', 'A4_ALPHA2.5_R8.0', 'A4_ALPHA2.5_R9.0', 'A4_ALPHA3.0_R0.0', 'A4_ALPHA3.0_R1.0', 'A4_ALPHA3.0_R10.0', 'A4_ALPHA3.0_R2.0', 'A4_ALPHA3.0_R3.0', 'A4_ALPHA3.0_R4.0', 'A4_ALPHA3.0_R5.0', 'A4_ALPHA3.0_R6.0', 'A4_ALPHA3.0_R7.0', 'A4_ALPHA3.0_R8.0', 'A4_ALPHA3.0_R9.0', 'A4_ALPHA3.5_R0.0', 'A4_ALPHA3.5_R1.0', 'A4_ALPHA3.5_R10.0', 'A4_ALPHA3.5_R2.0', 'A4_ALPHA3.5_R3.0', 'A4_ALPHA3.5_R4.0', 'A4_ALPHA3.5_R5.0', 'A4_ALPHA3.5_R6.0', 'A4_ALPHA3.5_R7.0', 'A4_ALPHA3.5_R8.0', 'A4_ALPHA3.5_R9.0', 'A4_ALPHA4.0_R0.0', 'A4_ALPHA4.0_R1.0', 'A4_ALPHA4.0_R10.0', 'A4_ALPHA4.0_R2.0', 'A4_ALPHA4.0_R3.0', 'A4_ALPHA4.0_R4.0', 'A4_ALPHA4.0_R5.0', 'A4_ALPHA4.0_R6.0', 'A4_ALPHA4.0_R7.0', 'A4_ALPHA4.0_R8.0', 'A4_ALPHA4.0_R9.0', 'A4_ALPHA4.5_R0.0', 'A4_ALPHA4.5_R1.0', 'A4_ALPHA4.5_R10.0', 'A4_ALPHA4.5_R2.0', 'A4_ALPHA4.5_R3.0', 'A4_ALPHA4.5_R4.0', 'A4_ALPHA4.5_R5.0', 'A4_ALPHA4.5_R6.0', 'A4_ALPHA4.5_R7.0', 'A4_ALPHA4.5_R8.0', 'A4_ALPHA4.5_R9.0', 'A4_ALPHA5.0_R0.0', 'A4_ALPHA5.0_R1.0', 'A4_ALPHA5.0_R10.0', 'A4_ALPHA5.0_R2.0', 'A4_ALPHA5.0_R3.0', 'A4_ALPHA5.0_R4.0', 'A4_ALPHA5.0_R5.0', 'A4_ALPHA5.0_R6.0', 'A4_ALPHA5.0_R7.0', 'A4_ALPHA5.0_R8.0', 'A4_ALPHA5.0_R9.0']
	dirs=dirs.encode('ascii', 'ignore')
	document=dirs[0:dirs.rfind('.')]
	docscore=0.5
	try:
		fileContent = open(document, "r")
		text=fileContent.read();
		fileContent.close();
		docscore=class_1(text);
	except (OSError, IOError) as e:
		docscore=0.5;

	files=[dirs+'/'+x for x in fnames]
	filename=dirs[dirs.rfind('/')+1:] 
	filename=filename[0:filename.rfind('.')]
	print filename,',',docscore,
	for filePath in files:
		score=0.5;
		try:
			fileContent = open(filePath, "r")
			text=fileContent.read();
			fileContent.close();
			score=class_1(text);
		except (OSError, IOError) as e:
			score=0.5
		print ','+str(score),
	print '\n',
			


path="/home/zerone/code/OpinionSummary/corpus/polar/txt_sentoken/neg/*.sum"
ldirs=glob.glob(path)
ldirs=sorted(ldirs)
for dirs in ldirs:
	func(dirs);

